(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{htnc:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a("mrSG"),o=a("lJxs"),s=a("nYR2"),r=a("fXoL"),d=a("I/3d"),n=a("Vaw3");let c=(()=>{class e{constructor(e,t){this.afs=e,this.storage=t,this.imagesCollection=this.afs.collection("images")}getAllImages(){return this.imagesCollection.snapshotChanges().pipe(Object(o.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({id:e.payload.doc.id},t)})))}getOneImage(e){return this.afs.doc(`images/${e}`).valueChanges()}deleteImageById(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.deleteFileImg(t),this.imagesCollection.doc(e.id).delete()}catch(a){console.log("Error:",a)}}))}updateImage(e,t,a,i){let o=!1;return a?this.uploadImageAddImage(e,a)&&(this.deleteFileImg(i),o=!0):(this.imagesCollection.doc(t).update(e),o=!0),o}addImage(e,t){return!!this.uploadImageAddImage(e,t)}saveImage(e){const t={codigo:e.codigo,descripcion:e.descripcion,fileUrl:this.downloadURL,categoria:e.categoria,fecha:new Date};return e.id?this.imagesCollection.doc(e.id).update(t):this.imagesCollection.add(t)}uploadImageAddImage(e,t){const a={data:!1,error:""};if(t){this.filePath=`images/${t.name}`;const i=this.storage.ref(this.filePath);return this.storage.upload(this.filePath,t).snapshotChanges().pipe(Object(s.a)(()=>{i.getDownloadURL().subscribe(t=>{this.downloadURL=t,this.saveImage(e),a.data=!0},e=>a.error=e)})).subscribe(),a}}deleteFileImg(e){return this.storage.storage.refFromURL(e).delete()}}return e.\u0275fac=function(t){return new(t||e)(r.ac(d.a),r.ac(n.a))},e.\u0275prov=r.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);